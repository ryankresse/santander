{"paragraphs":[{"text":"%pyspark\nfrom pyspark.sql import SparkSession\nfrom pyspark.conf import SparkConf\nfrom pyspark.sql.types import *\ntrain_df = spark.read.csv(path=\"s3://ryan-sant/input/parsed.csv/train_df.csv.gz\",header=True)","dateUpdated":"2016-11-13T16:10:48+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479041002521_1894074181","id":"20161111-184129_347913045","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2016-11-13T12:43:22+0000","dateStarted":"2016-11-13T15:17:20+0000","dateFinished":"2016-11-13T15:17:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8693","focus":true},{"text":"%pyspark\ntrain_df = spark.read.csv(path=\"s3://ryan-sant/input/parsed.csv/train_df.csv.gz\",header=True)","dateUpdated":"2016-11-13T15:21:14+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479041002528_1879068974","id":"20161112-125403_1443504025","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2016-11-13T12:43:22+0000","dateStarted":"2016-11-13T15:21:14+0000","dateFinished":"2016-11-13T15:21:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8694"},{"text":"%pyspark\ndf_2 = spark.read.csv(path=\"s3://ryan-sant/input/train_ver2.csv.gz\",header=True)","dateUpdated":"2016-11-13T15:26:38+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479050487786_1987795417","id":"20161113-152127_662148791","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2016-11-13T15:21:27+0000","dateStarted":"2016-11-13T15:26:38+0000","dateFinished":"2016-11-13T15:26:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8695"},{"text":"%pyspark\ndf_2.show(3)","dateUpdated":"2016-11-13T15:26:54+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479050678827_1170633081","id":"20161113-152438_9422993","result":{"code":"SUCCESS","type":"TEXT","msg":"+----------+--------+------------+---------------+----+---+----------+---------+----------+------+--------------+-----------+-----------+-------+------+--------+-------------+-------+-------+--------+-----------+---------------------+------------------+------------------+-----------------+-----------------+----------------+-----------------+----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+----------------+-----------------+-----------------+-----------------+-----------------+-----------------+----------------+---------------+-----------------+---------------+\n|fecha_dato|ncodpers|ind_empleado|pais_residencia|sexo|age|fecha_alta|ind_nuevo|antiguedad|indrel|ult_fec_cli_1t|indrel_1mes|tiprel_1mes|indresi|indext|conyuemp|canal_entrada|indfall|tipodom|cod_prov|    nomprov|ind_actividad_cliente|             renta|          segmento|ind_ahor_fin_ult1|ind_aval_fin_ult1|ind_cco_fin_ult1|ind_cder_fin_ult1|ind_cno_fin_ult1|ind_ctju_fin_ult1|ind_ctma_fin_ult1|ind_ctop_fin_ult1|ind_ctpp_fin_ult1|ind_deco_fin_ult1|ind_deme_fin_ult1|ind_dela_fin_ult1|ind_ecue_fin_ult1|ind_fond_fin_ult1|ind_hip_fin_ult1|ind_plan_fin_ult1|ind_pres_fin_ult1|ind_reca_fin_ult1|ind_tjcr_fin_ult1|ind_valo_fin_ult1|ind_viv_fin_ult1|ind_nomina_ult1|ind_nom_pens_ult1|ind_recibo_ult1|\n+----------+--------+------------+---------------+----+---+----------+---------+----------+------+--------------+-----------+-----------+-------+------+--------+-------------+-------+-------+--------+-----------+---------------------+------------------+------------------+-----------------+-----------------+----------------+-----------------+----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+----------------+-----------------+-----------------+-----------------+-----------------+-----------------+----------------+---------------+-----------------+---------------+\n|2015-01-28| 1375586|           N|             ES|   H| 35|2015-01-12|        0|         6|     1|          null|        1.0|          A|      S|     N|    null|          KHL|      N|      1|      29|     MALAGA|                    1|           87218.1| 02 - PARTICULARES|                0|                0|               1|                0|               0|                0|                0|                0|                0|                0|                0|                0|                0|                0|               0|                0|                0|                0|                0|                0|               0|              0|                0|              0|\n|2015-01-28| 1050611|           N|             ES|   V| 23|2012-08-10|        0|        35|     1|          null|          1|          I|      S|     S|    null|          KHE|      N|      1|      13|CIUDAD REAL|                    0|          35548.74|03 - UNIVERSITARIO|                0|                0|               1|                0|               0|                0|                0|                0|                0|                0|                0|                0|                0|                0|               0|                0|                0|                0|                0|                0|               0|              0|                0|              0|\n|2015-01-28| 1050612|           N|             ES|   V| 23|2012-08-10|        0|        35|     1|          null|          1|          I|      S|     N|    null|          KHE|      N|      1|      13|CIUDAD REAL|                    0|122179.11000000002|03 - UNIVERSITARIO|                0|                0|               1|                0|               0|                0|                0|                0|                0|                0|                0|                0|                0|                0|               0|                0|                0|                0|                0|                0|               0|              0|                0|              0|\n+----------+--------+------------+---------------+----+---+----------+---------+----------+------+--------------+-----------+-----------+-------+------+--------+-------------+-------+-------+--------+-----------+---------------------+------------------+------------------+-----------------+-----------------+----------------+-----------------+----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+----------------+-----------------+-----------------+-----------------+-----------------+-----------------+----------------+---------------+-----------------+---------------+\nonly showing top 3 rows\n\n"},"dateCreated":"2016-11-13T15:24:38+0000","dateStarted":"2016-11-13T15:26:54+0000","dateFinished":"2016-11-13T15:26:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8696"},{"text":"%pyspark\ndf_2.count()\n","dateUpdated":"2016-11-13T15:27:45+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479050806250_-1247362159","id":"20161113-152646_11309223","result":{"code":"SUCCESS","type":"TEXT","msg":"13647309\n"},"dateCreated":"2016-11-13T15:26:46+0000","dateStarted":"2016-11-13T15:27:45+0000","dateFinished":"2016-11-13T15:29:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8697"},{"text":"%pyspark\nimport pandas as pd","dateUpdated":"2016-11-13T15:35:37+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479050853350_-1756338981","id":"20161113-152733_1780112658","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2016-11-13T15:27:33+0000","dateStarted":"2016-11-13T15:35:37+0000","dateFinished":"2016-11-13T15:35:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8698"},{"text":"%pyspark\nsample = df_2.sample(True, 0.0025)\nsample.count()","dateUpdated":"2016-11-13T15:40:57+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479051337058_440679051","id":"20161113-153537_1204153286","result":{"code":"SUCCESS","type":"TEXT","msg":"33937\n"},"dateCreated":"2016-11-13T15:35:37+0000","dateStarted":"2016-11-13T15:40:57+0000","dateFinished":"2016-11-13T15:42:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8699"},{"text":"%pyspark\nsample.show(1)\npd_sample = sample.toPandas()","dateUpdated":"2016-11-13T15:43:47+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479051371530_-567301771","id":"20161113-153611_1400236482","result":{"code":"SUCCESS","type":"TEXT","msg":"+----------+--------+------------+---------------+----+---+----------+---------+----------+------+--------------+-----------+-----------+-------+------+--------+-------------+-------+-------+--------+-------+---------------------+--------+------------------+-----------------+-----------------+----------------+-----------------+----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+----------------+-----------------+-----------------+-----------------+-----------------+-----------------+----------------+---------------+-----------------+---------------+\n|fecha_dato|ncodpers|ind_empleado|pais_residencia|sexo|age|fecha_alta|ind_nuevo|antiguedad|indrel|ult_fec_cli_1t|indrel_1mes|tiprel_1mes|indresi|indext|conyuemp|canal_entrada|indfall|tipodom|cod_prov|nomprov|ind_actividad_cliente|   renta|          segmento|ind_ahor_fin_ult1|ind_aval_fin_ult1|ind_cco_fin_ult1|ind_cder_fin_ult1|ind_cno_fin_ult1|ind_ctju_fin_ult1|ind_ctma_fin_ult1|ind_ctop_fin_ult1|ind_ctpp_fin_ult1|ind_deco_fin_ult1|ind_deme_fin_ult1|ind_dela_fin_ult1|ind_ecue_fin_ult1|ind_fond_fin_ult1|ind_hip_fin_ult1|ind_plan_fin_ult1|ind_pres_fin_ult1|ind_reca_fin_ult1|ind_tjcr_fin_ult1|ind_valo_fin_ult1|ind_viv_fin_ult1|ind_nomina_ult1|ind_nom_pens_ult1|ind_recibo_ult1|\n+----------+--------+------------+---------------+----+---+----------+---------+----------+------+--------------+-----------+-----------+-------+------+--------+-------------+-------+-------+--------+-------+---------------------+--------+------------------+-----------------+-----------------+----------------+-----------------+----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+----------------+-----------------+-----------------+-----------------+-----------------+-----------------+----------------+---------------+-----------------+---------------+\n|2015-01-28| 1050148|           N|             ES|   H| 23|2012-08-10|        0|        35|     1|          null|          1|          I|      S|     N|    null|          KHE|      N|      1|      45| TOLEDO|                    0|28305.36|03 - UNIVERSITARIO|                0|                0|               1|                0|               0|                0|                0|                0|                0|                0|                0|                0|                0|                0|               0|                0|                0|                0|                0|                0|               0|              0|                0|              0|\n+----------+--------+------------+---------------+----+---+----------+---------+----------+------+--------------+-----------+-----------+-------+------+--------+-------------+-------+-------+--------+-------+---------------------+--------+------------------+-----------------+-----------------+----------------+-----------------+----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+----------------+-----------------+-----------------+-----------------+-----------------+-----------------+----------------+---------------+-----------------+---------------+\nonly showing top 1 row\n\n"},"dateCreated":"2016-11-13T15:36:11+0000","dateStarted":"2016-11-13T15:43:47+0000","dateFinished":"2016-11-13T15:48:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8700"},{"text":"%pyspark\nsample.write.csv(\"s3://ryan-sant/input/sample.csv\", header=True, compression='gzip')","dateUpdated":"2016-11-13T15:52:25+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479051858438_-69162504","id":"20161113-154418_1464127860","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2016-11-13T15:44:18+0000","dateStarted":"2016-11-13T15:52:25+0000","dateFinished":"2016-11-13T15:57:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8701"},{"text":"","dateUpdated":"2016-11-13T15:39:14+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1479051543824_-1259386777","id":"20161113-153903_1271467521","dateCreated":"2016-11-13T15:39:03+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:8702"}],"name":"parse_and_sample","id":"2C38RCPSQ","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}